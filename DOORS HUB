-- DOORS HUB v1.5 FINAL
-- –¢–†–ï–ö–ï–†–´ –ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–´

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")
local CoreGui = game:GetService("CoreGui")
local Camera = Workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ Drawing API
local DrawingSupported = false
local DrawingAPI = nil

-- –ü—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∑–∞–≥—Ä—É–∑–∫–∏ Drawing
pcall(function()
    DrawingAPI = Drawing
    if DrawingAPI and DrawingAPI.new then
        local test = DrawingAPI.new("Line")
        if test then
            test:Remove()
            DrawingSupported = true
        end
    end
end)

if not DrawingSupported then
    pcall(function()
        DrawingAPI = loadstring(game:HttpGet("https://raw.githubusercontent.com/Blissful4992/Miscellaneous/main/DrawingAPI.lua"))()
        if DrawingAPI then
            DrawingSupported = true
        end
    end)
end

if not DrawingSupported then
    warn("Drawing API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è! –¢—Ä–µ–∫–µ—Ä—ã –±—É–¥—É—Ç –æ—Ç–∫–ª—é—á–µ–Ω—ã")
else
    print("‚úÖ Drawing API –∑–∞–≥—Ä—É–∂–µ–Ω! –¢—Ä–µ–∫–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç!")
end

-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
local Config = {
    ESP = {
        Enabled = true,
        Doors = true,
        Keys = true,
        Items = true,
        Entities = true,
        Tracers = true,
        ShowDistance = true,
        MaxDistance = 500,
        RefreshRate = 1,
        DoorRange = 2,
        MaxDoorsESP = 3
    },
    Speed = {
        Enabled = false,
        Value = 20
    },
    GodMode = {
        Enabled = false
    },
    Colors = {
        Door = Color3.fromRGB(0, 255, 0),
        Key = Color3.fromRGB(255, 215, 0),
        Lever = Color3.fromRGB(255, 100, 255),
        Item = Color3.fromRGB(0, 191, 255),
        Entity = Color3.fromRGB(255, 0, 0),
        Tracer = Color3.fromRGB(255, 255, 255)
    }
}

-- –°–ø–∏—Å–æ–∫ –≤–∞–∂–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
local ImportantItems = {
    ["Key"] = {Name = "–ö–ª—é—á", Color = Config.Colors.Key, Priority = 1},
    ["KeyObtain"] = {Name = "–ö–ª—é—á", Color = Config.Colors.Key, Priority = 1},
    ["Lockpick"] = {Name = "–û—Ç–º—ã—á–∫–∞", Color = Config.Colors.Item, Priority = 2},
    ["Crucifix"] = {Name = "–ö—Ä–µ—Å—Ç", Color = Config.Colors.Item, Priority = 2},
    ["Lighter"] = {Name = "–ó–∞–∂–∏–≥–∞–ª–∫–∞", Color = Config.Colors.Item, Priority = 3},
    ["FlashlightToggle"] = {Name = "–§–æ–Ω–∞—Ä–∏–∫", Color = Config.Colors.Item, Priority = 3},
    ["Battery"] = {Name = "–ë–∞—Ç–∞—Ä–µ–π–∫–∞", Color = Config.Colors.Item, Priority = 4},
    ["Vitamins"] = {Name = "–í–∏—Ç–∞–º–∏–Ω—ã", Color = Config.Colors.Item, Priority = 3},
    ["SkeletonKey"] = {Name = "–°–∫–µ–ª–µ—Ç –ö–ª—é—á", Color = Config.Colors.Key, Priority = 1},
    ["LibraryHintPaper"] = {Name = "–ü–æ–¥—Å–∫–∞–∑–∫–∞", Color = Config.Colors.Item, Priority = 2},
    ["Shears"] = {Name = "–ù–æ–∂–Ω–∏—Ü—ã", Color = Config.Colors.Item, Priority = 2}
}

-- –°–ø–∏—Å–æ–∫ –º–æ–Ω—Å—Ç—Ä–æ–≤
local EntityNames = {
    ["RushMoving"] = "Rush",
    ["AmbushMoving"] = "Ambush",
    ["Eyes"] = "Eyes",
    ["Screech"] = "Screech",
    ["Halt"] = "Halt",
    ["Seek"] = "Seek",
    ["Figure"] = "Figure",
    ["Jeff"] = "Jeff",
    ["Shadow"] = "Shadow",
    ["Rush"] = "Rush",
    ["Ambush"] = "Ambush",
    ["GiggleCeiling"] = "Giggle",
    ["GloombatSwarm"] = "Gloombat",
    ["A60"] = "A-60",
    ["A120"] = "A-120"
}

-- ESP –ö–ª–∞—Å—Å
local ESP = {}
ESP.Objects = {}
ESP.Connections = {}
ESP.Tracers = {} -- –û—Ç–¥–µ–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è —Ç—Ä–µ–∫–µ—Ä–æ–≤
ESP.DoorESP = {}
ESP.CurrentPlayerRoom = 0
ESP.LastCleanup = 0

-- –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏ –¥–ª—è ESP
local ESPFolder = Instance.new("Folder")
ESPFolder.Name = "ESPHolder"
ESPFolder.Parent = Camera

-- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞ –æ–±—ä–µ–∫—Ç–∞
local function GetCenter(obj)
    if obj:IsA("Model") then
        local cf, size = obj:GetBoundingBox()
        return cf.Position
    elseif obj:IsA("BasePart") then
        return obj.Position
    elseif obj:FindFirstChildWhichIsA("BasePart") then
        return obj:FindFirstChildWhichIsA("BasePart").Position
    end
    return nil
end

-- –ü–æ–ª—É—á–µ–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–π —á–∞—Å—Ç–∏
local function GetPrimaryPart(obj)
    if obj:IsA("Model") then
        return obj.PrimaryPart or obj:FindFirstChildWhichIsA("BasePart")
    elseif obj:IsA("BasePart") then
        return obj
    else
        return obj:FindFirstChildWhichIsA("BasePart", true)
    end
end

-- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∫–æ–º–Ω–∞—Ç—ã
local function GetCurrentRoom()
    local character = LocalPlayer.Character
    if not character then return 0 end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return 0 end
    
    local currentRooms = Workspace:FindFirstChild("CurrentRooms")
    if not currentRooms then return 0 end
    
    local closestRoom = 0
    local closestDistance = math.huge
    
    for _, room in pairs(currentRooms:GetChildren()) do
        local roomNumber = tonumber(room.Name)
        if roomNumber then
            local roomEntry = room:FindFirstChild("RoomEntrance") or 
                             room:FindFirstChild("RoomStart") or
                             room:FindFirstChild("Door") or
                             room:FindFirstChildWhichIsA("BasePart", true)
            
            if roomEntry then
                local entryPos = GetCenter(roomEntry) or roomEntry.Position
                local distance = (humanoidRootPart.Position - entryPos).Magnitude
                
                if distance < closestDistance then
                    closestDistance = distance
                    closestRoom = roomNumber
                end
            end
        end
    end
    
    return closestRoom
end

-- –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–µ–∫–µ—Ä–∞
local function CreateTracer(color)
    if not DrawingSupported or not DrawingAPI then return nil end
    
    local success, tracer = pcall(function()
        local line = DrawingAPI.new("Line")
        line.Visible = false
        line.Color = color or Color3.new(1, 1, 1)
        line.Thickness = 2
        line.Transparency = 0.8
        return line
    end)
    
    if success then
        return tracer
    else
        return nil
    end
end

-- –°–æ–∑–¥–∞–Ω–∏–µ ESP
function ESP:Add(instance, espType, customName, customColor)
    if not instance or self.Objects[instance] then return end
    
    -- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è –¥–≤–µ—Ä–µ–π
    if espType == "Door" then
        local doorCount = 0
        for _, data in pairs(self.DoorESP) do
            doorCount = doorCount + 1
        end
        
        if doorCount >= Config.ESP.MaxDoorsESP then
            local oldestDoor = nil
            local oldestRoom = math.huge
            
            for door, data in pairs(self.DoorESP) do
                if data.RoomNumber and data.RoomNumber < oldestRoom then
                    oldestRoom = data.RoomNumber
                    oldestDoor = door
                end
            end
            
            if oldestDoor then
                self:Remove(oldestDoor)
            end
        end
    end
    
    local success, result = pcall(function()
        local color = customColor or Config.Colors[espType] or Color3.fromRGB(255, 255, 255)
        local name = customName or instance.Name
        
        local espData = {
            Instance = instance,
            Type = espType,
            Name = name,
            Color = color,
            Visible = true,
            Components = {},
            RoomNumber = nil,
            CreatedAt = tick()
        }
        
        if espType == "Door" then
            local roomNum = tonumber(string.match(name, "%d+"))
            espData.RoomNumber = roomNum or 0
        end
        
        local primaryPart = GetPrimaryPart(instance)
        if not primaryPart then return end
        
        -- 1. HIGHLIGHT
        if espType ~= "Door" or (espData.RoomNumber and math.abs(espData.RoomNumber - self.CurrentPlayerRoom) <= 2) then
            if espType == "Door" then
                local doorPart = instance:FindFirstChild("Door") or instance:FindFirstChildWhichIsA("BasePart")
                if doorPart then
                    local highlight = Instance.new("Highlight")
                    highlight.Name = "ESP_Highlight"
                    highlight.Adornee = doorPart
                    highlight.FillColor = color
                    highlight.OutlineColor = color
                    highlight.FillTransparency = 0.7
                    highlight.OutlineTransparency = 0.4
                    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                    highlight.Parent = ESPFolder
                    espData.Components.Highlight = highlight
                end
            else
                local highlight = Instance.new("Highlight")
                highlight.Name = "ESP_Highlight"
                highlight.Adornee = instance
                highlight.FillColor = color
                highlight.OutlineColor = color
                highlight.FillTransparency = espType == "Lever" and 0.4 or 0.5
                highlight.OutlineTransparency = espType == "Lever" and 0.2 or 0.2
                highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                highlight.Parent = ESPFolder
                espData.Components.Highlight = highlight
            end
        end
        
        -- 2. BILLBOARD
        if espType ~= "Door" or (espData.RoomNumber and math.abs(espData.RoomNumber - self.CurrentPlayerRoom) <= Config.ESP.DoorRange) then
            local billboard = Instance.new("BillboardGui")
            billboard.Name = "ESP_Billboard"
            billboard.Adornee = primaryPart
            billboard.Size = UDim2.new(0, 200, 0, 50)
            billboard.StudsOffset = Vector3.new(0, espType == "Door" and 4 or 3, 0)
            billboard.AlwaysOnTop = true
            billboard.MaxDistance = Config.ESP.MaxDistance
            billboard.Parent = ESPFolder
            
            local textLabel = Instance.new("TextLabel")
            textLabel.Size = UDim2.new(1, 0, 1, 0)
            textLabel.BackgroundTransparency = 1
            textLabel.TextColor3 = color
            textLabel.TextStrokeTransparency = 0
            textLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
            textLabel.Font = Enum.Font.GothamBold
            textLabel.TextSize = espType == "Door" and 14 or 16
            textLabel.Text = name
            textLabel.Parent = billboard
            
            espData.Components.Billboard = billboard
            espData.Components.TextLabel = textLabel
        end
        
        -- 3. TRACER - –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô
        if Config.ESP.Tracers and DrawingSupported then
            local tracer = CreateTracer(color)
            if tracer then
                espData.Components.Tracer = tracer
                self.Tracers[instance] = tracer
            end
        end
        
        -- 4. BOX –¥–ª—è –º–æ–Ω—Å—Ç—Ä–æ–≤ –∏ —Ä—ã—á–∞–≥–æ–≤
        if espType == "Entity" or espType == "Lever" then
            local boxHandles = Instance.new("BoxHandleAdornment")
            boxHandles.Name = "ESP_Box"
            boxHandles.Adornee = primaryPart
            boxHandles.Size = primaryPart.Size * 1.2
            boxHandles.Color3 = color
            boxHandles.Transparency = 0.6
            boxHandles.AlwaysOnTop = true
            boxHandles.ZIndex = 1
            boxHandles.Parent = ESPFolder
            
            espData.Components.Box = boxHandles
        end
        
        self.Objects[instance] = espData
        
        if espType == "Door" then
            self.DoorESP[instance] = espData
        end
        
        local connection = instance.AncestryChanged:Connect(function(_, parent)
            if not parent then
                self:Remove(instance)
            end
        end)
        
        espData.Connection = connection
        
        return espData
    end)
    
    if not success then
        warn("ESP Add Error:", result)
    end
end

-- –£–¥–∞–ª–µ–Ω–∏–µ ESP
function ESP:Remove(instance)
    local espData = self.Objects[instance]
    if not espData then return end
    
    pcall(function()
        for name, component in pairs(espData.Components) do
            if component then
                if typeof(component) == "Instance" then
                    component:Destroy()
                elseif name == "Tracer" then
                    pcall(function() 
                        component:Remove() 
                    end)
                end
            end
        end
        
        if espData.Connection then
            espData.Connection:Disconnect()
        end
        
        -- –£–¥–∞–ª—è–µ–º —Ç—Ä–µ–∫–µ—Ä –∏–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
        if self.Tracers[instance] then
            pcall(function()
                self.Tracers[instance]:Remove()
            end)
            self.Tracers[instance] = nil
        end
        
        self.Objects[instance] = nil
        self.DoorESP[instance] = nil
    end)
end

-- –û—á–∏—Å—Ç–∫–∞ ESP
function ESP:Clear()
    for instance, _ in pairs(self.Objects) do
        self:Remove(instance)
    end
    
    -- –û—á–∏—â–∞–µ–º –≤—Å–µ —Ç—Ä–µ–∫–µ—Ä—ã
    for _, tracer in pairs(self.Tracers) do
        pcall(function()
            tracer:Remove()
        end)
    end
    
    self.Objects = {}
    self.Tracers = {}
    self.DoorESP = {}
end

-- –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–≤–µ—Ä–µ–π
function ESP:AggressiveCleanDoors()
    local currentRoom = GetCurrentRoom()
    self.CurrentPlayerRoom = currentRoom
    
    local removed = 0
    local toRemove = {}
    
    for doorInstance, doorData in pairs(self.DoorESP) do
        local shouldRemove = false
        
        if doorData.RoomNumber and doorData.RoomNumber < (currentRoom - 1) then
            shouldRemove = true
        end
        
        if doorData.RoomNumber and doorData.RoomNumber > (currentRoom + Config.ESP.DoorRange) then
            shouldRemove = true
        end
        
        if doorData.CreatedAt and (tick() - doorData.CreatedAt) > 60 then
            shouldRemove = true
        end
        
        if not doorInstance or not doorInstance.Parent then
            shouldRemove = true
        end
        
        if shouldRemove then
            table.insert(toRemove, doorInstance)
        end
    end
    
    for _, doorInstance in ipairs(toRemove) do
        self:Remove(doorInstance)
        removed = removed + 1
    end
    
    local doorCount = 0
    for _ in pairs(self.DoorESP) do
        doorCount = doorCount + 1
    end
    
    if doorCount > Config.ESP.MaxDoorsESP then
        local doors = {}
        for door, data in pairs(self.DoorESP) do
            table.insert(doors, {instance = door, room = data.RoomNumber or 0})
        end
        
        table.sort(doors, function(a, b) return a.room < b.room end)
        
        for i = 1, doorCount - Config.ESP.MaxDoorsESP do
            if doors[i] then
                self:Remove(doors[i].instance)
                removed = removed + 1
            end
        end
    end
    
    return removed
end

-- –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ï –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ESP —Å —Ä–∞–±–æ—á–∏–º–∏ —Ç—Ä–µ–∫–µ—Ä–∞–º–∏
function ESP:Update()
    if not Config.ESP.Enabled then 
        -- –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ç—Ä–µ–∫–µ—Ä—ã
        for _, tracer in pairs(self.Tracers) do
            pcall(function()
                tracer.Visible = false
            end)
        end
        return 
    end
    
    local character = LocalPlayer.Character
    if not character then return end
    
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return end
    
    -- –ü–æ–∑–∏—Ü–∏—è –¥–ª—è —Ç—Ä–µ–∫–µ—Ä–æ–≤ (–≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞)
    local screenSize = Camera.ViewportSize
    local bottomCenter = Vector2.new(screenSize.X / 2, screenSize.Y - 100)
    local currentRoom = GetCurrentRoom()
    
    for instance, espData in pairs(self.Objects) do
        pcall(function()
            if not instance or not instance.Parent then
                self:Remove(instance)
                return
            end
            
            local position = GetCenter(instance)
            if not position then return end
            
            local distance = (rootPart.Position - position).Magnitude
            local visible = distance <= Config.ESP.MaxDistance
            
            -- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –¥–≤–µ—Ä–µ–π
            if espData.Type == "Door" then
                if espData.RoomNumber then
                    if espData.RoomNumber < (currentRoom - 1) or 
                       espData.RoomNumber > (currentRoom + Config.ESP.DoorRange) then
                        visible = false
                        self:Remove(instance)
                        return
                    end
                end
            end
            
            -- –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
            for name, component in pairs(espData.Components) do
                if name == "Tracer" then
                    -- –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –¢–†–ï–ö–ï–†–´
                    if Config.ESP.Tracers and visible and DrawingSupported then
                        local success = pcall(function()
                            local screenPos, onScreen = Camera:WorldToViewportPoint(position)
                            
                            if onScreen and screenPos.Z > 0 then
                                -- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–æ—á–∫–∏ –ª–∏–Ω–∏–∏
                                component.From = bottomCenter
                                component.To = Vector2.new(screenPos.X, screenPos.Y)
                                component.Color = espData.Color
                                component.Transparency = 0.8
                                component.Thickness = 2
                                component.Visible = true
                            else
                                component.Visible = false
                            end
                        end)
                        
                        if not success then
                            component.Visible = false
                        end
                    else
                        pcall(function()
                            component.Visible = false
                        end)
                    end
                    
                elseif name ~= "TextLabel" and typeof(component) == "Instance" then
                    component.Enabled = visible
                end
            end
            
            -- –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å –¥–∏—Å—Ç–∞–Ω—Ü–∏–µ–π
            if espData.Components.TextLabel and Config.ESP.ShowDistance then
                local distText = math.floor(distance)
                espData.Components.TextLabel.Text = string.format("%s [%dm]", espData.Name, distText)
                
                if distance < 50 then
                    espData.Components.TextLabel.TextSize = 18
                elseif distance < 150 then
                    espData.Components.TextLabel.TextSize = 16
                else
                    espData.Components.TextLabel.TextSize = 14
                end
            end
            
            -- –ü—É–ª—å—Å–∞—Ü–∏—è –¥–ª—è –º–æ–Ω—Å—Ç—Ä–æ–≤ –∏ —Ä—ã—á–∞–≥–æ–≤
            if (espData.Type == "Entity" or espData.Type == "Lever") and espData.Components.Highlight then
                local pulse = 0.5 + (math.sin(tick() * 3) * 0.3)
                espData.Components.Highlight.FillTransparency = pulse
                espData.Components.Highlight.OutlineTransparency = pulse * 0.5
            end
        end)
    end
end

-- –ü–æ–∏—Å–∫ —Ä—ã—á–∞–≥–æ–≤
local function FindLevers(room)
    local levers = {}
    
    local assets = room:FindFirstChild("Assets")
    if assets then
        for _, obj in pairs(assets:GetDescendants()) do
            if obj.Name == "LeverForGate" or obj.Name:find("Lever") then
                table.insert(levers, obj)
            end
        end
    end
    
    for _, obj in pairs(room:GetDescendants()) do
        if obj.Name == "LeverForGate" or (obj.Name:find("Lever") and obj:IsA("Model")) then
            if not table.find(levers, obj) then
                table.insert(levers, obj)
            end
        end
    end
    
    return levers
end

-- –ü–æ–∏—Å–∫ –æ–±—ä–µ–∫—Ç–æ–≤
function ESP:ScanWorkspace()
    task.spawn(function()
        while task.wait(Config.ESP.RefreshRate) do
            if not Config.ESP.Enabled then continue end
            
            pcall(function()
                local currentRooms = Workspace:FindFirstChild("CurrentRooms")
                if not currentRooms then return end
                
                local currentRoom = GetCurrentRoom()
                self.CurrentPlayerRoom = currentRoom
                
                if tick() - self.LastCleanup > 2 then
                    local removed = self:AggressiveCleanDoors()
                    if removed > 0 then
                        print(string.format("üßπ –£–¥–∞–ª–µ–Ω–æ ESP –¥–≤–µ—Ä–µ–π: %d | –ö–æ–º–Ω–∞—Ç–∞: %d", removed, currentRoom))
                    end
                    self.LastCleanup = tick()
                end
                
                -- 1. –î–í–ï–†–ò
                if Config.ESP.Doors then
                    local currentDoorESP = 0
                    for _ in pairs(self.DoorESP) do
                        currentDoorESP = currentDoorESP + 1
                    end
                    
                    if currentDoorESP < Config.ESP.MaxDoorsESP then
                        for _, room in pairs(currentRooms:GetChildren()) do
                            local roomNumber = tonumber(room.Name) or 0
                            
                            if roomNumber >= currentRoom and roomNumber <= (currentRoom + Config.ESP.DoorRange) then
                                local door = room:FindFirstChild("Door")
                                if door and door:IsA("Model") and not self.Objects[door] then
                                    self:Add(door, "Door", "üö™ " .. room.Name, Config.Colors.Door)
                                end
                            end
                        end
                    end
                end
                
                -- 2. –ö–õ–Æ–ß–ò –ò –†–´–ß–ê–ì–ò
                if Config.ESP.Keys then
                    for _, item in pairs(currentRooms:GetDescendants()) do
                        if ImportantItems[item.Name] then
                            local itemData = ImportantItems[item.Name]
                            if item.Name:find("Key") and not self.Objects[item] then
                                if item:IsA("Model") or item:FindFirstChildWhichIsA("BasePart") then
                                    self:Add(item, "Key", itemData.Name, itemData.Color)
                                end
                            end
                        end
                    end
                    
                    for _, room in pairs(currentRooms:GetChildren()) do
                        local levers = FindLevers(room)
                        for _, lever in pairs(levers) do
                            if not self.Objects[lever] then
                                local roomNumber = room.Name
                                self:Add(lever, "Lever", "üéÆ –†—ã—á–∞–≥ [" .. roomNumber .. "]", Config.Colors.Lever)
                            end
                        end
                    end
                end
                
                -- 3. –ü–†–ï–î–ú–ï–¢–´
                if Config.ESP.Items then
                    for _, item in pairs(currentRooms:GetDescendants()) do
                        if ImportantItems[item.Name] and not self.Objects[item] then
                            local itemData = ImportantItems[item.Name]
                            if not item.Name:find("Key") then
                                if item:IsA("Model") or item:FindFirstChildWhichIsA("BasePart") then
                                    self:Add(item, "Item", itemData.Name, itemData.Color)
                                end
                            end
                        end
                    end
                end
                
                -- 4. –ú–û–ù–°–¢–†–´
                if Config.ESP.Entities then
                    local searchAreas = {
                        Workspace,
                        currentRooms,
                        Workspace:FindFirstChild("Rooms") or game
                    }
                    
                    for _, area in pairs(searchAreas) do
                        for _, entity in pairs(area:GetDescendants()) do
                            if EntityNames[entity.Name] and not self.Objects[entity] then
                                local displayName = "‚ö†Ô∏è " .. EntityNames[entity.Name] .. " ‚ö†Ô∏è"
                                self:Add(entity, "Entity", displayName, Config.Colors.Entity)
                            end
                        end
                    end
                end
                
                -- –û—á–∏—Å—Ç–∫–∞ –º–µ—Ä—Ç–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
                for instance, espData in pairs(self.Objects) do
                    if not instance or not instance.Parent then
                        self:Remove(instance)
                    elseif espData.Type == "Door" and espData.RoomNumber then
                        if espData.RoomNumber < (currentRoom - 1) then
                            self:Remove(instance)
                        end
                    end
                end
            end)
        end
    end)
end

-- God Mode
local GodMode = {}
GodMode.Connections = {}

function GodMode:Enable()
    pcall(function()
        local character = LocalPlayer.Character
        if not character then return end
        
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if not humanoid then return end
        
        if GodMode.Connections.HealthChanged then
            GodMode.Connections.HealthChanged:Disconnect()
        end
        
        GodMode.Connections.HealthChanged = humanoid.HealthChanged:Connect(function(health)
            if health < humanoid.MaxHealth and Config.GodMode.Enabled then
                humanoid.Health = humanoid.MaxHealth
            end
        end)
        
        humanoid.Health = humanoid.MaxHealth
    end)
end

function GodMode:Disable()
    for _, conn in pairs(GodMode.Connections) do
        pcall(function() conn:Disconnect() end)
    end
    GodMode.Connections = {}
end

-- –°–∏—Å—Ç–µ–º–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏
local SpeedSystem = {}
SpeedSystem.Connection = nil

function SpeedSystem:Enable()
    pcall(function()
        if self.Connection then
            self.Connection:Disconnect()
            self.Connection = nil
        end
        
        self.Connection = RunService.Heartbeat:Connect(function()
            if not Config.Speed.Enabled then return end
            
            local character = LocalPlayer.Character
            if not character then return end
            
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if not humanoid then return end
            
            if humanoid.WalkSpeed ~= Config.Speed.Value then
                humanoid.WalkSpeed = Config.Speed.Value
            end
        end)
    end)
end

function SpeedSystem:Disable()
    pcall(function()
        if self.Connection then
            self.Connection:Disconnect()
            self.Connection = nil
        end
        
        local character = LocalPlayer.Character
        if character then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = 16
            end
        end
    end)
end

-- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ GUI
pcall(function()
    if CoreGui:FindFirstChild("DoorsHub") then
        CoreGui:FindFirstChild("DoorsHub"):Destroy()
    end
end)

wait(0.3)

-- GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "DoorsHub"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.IgnoreGuiInset = true

pcall(function()
    ScreenGui.Parent = CoreGui
end)

if not ScreenGui.Parent then
    ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
end

-- –ì–ª–∞–≤–Ω—ã–π —Ñ—Ä–µ–π–º
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 450, 0, 670)
MainFrame.Position = UDim2.new(0.5, -225, 0.5, -335)
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Parent = ScreenGui

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 15)
MainCorner.Parent = MainFrame

local Gradient = Instance.new("UIGradient")
Gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(30, 30, 45)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(15, 15, 25))
}
Gradient.Rotation = 45
Gradient.Parent = MainFrame

-- –ó–∞–≥–æ–ª–æ–≤–æ–∫
local Title = Instance.new("TextLabel")
Title.Name = "Title"
Title.Size = UDim2.new(1, 0, 0, 70)
Title.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
Title.Text = "üéØ DOORS HUB"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 28
Title.BorderSizePixel = 0
Title.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 15)
TitleCorner.Parent = Title

local TitleGradient = Instance.new("UIGradient")
TitleGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(60, 60, 90)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(50, 50, 75)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(40, 40, 60))
}
TitleGradient.Rotation = 90
TitleGradient.Parent = Title

local TitleStroke = Instance.new("UIStroke")
TitleStroke.Color = Color3.fromRGB(100, 200, 255)
TitleStroke.Thickness = 2
TitleStroke.Transparency = 0.3
TitleStroke.Parent = Title

-- –í–µ—Ä—Å–∏—è
local Version = Instance.new("TextLabel")
Version.Size = UDim2.new(0, 100, 0, 25)
Version.Position = UDim2.new(1, -110, 0, 40)
Version.BackgroundTransparency = 1
Version.Text = "v1.5"
Version.TextColor3 = Color3.fromRGB(0, 255, 100)
Version.Font = Enum.Font.GothamBold
Version.TextSize = 12
Version.Parent = Title

-- –°—Ç–∞—Ç—É—Å
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Size = UDim2.new(0, 200, 0, 20)
StatusLabel.Position = UDim2.new(0, 15, 0, 45)
StatusLabel.BackgroundTransparency = 1
StatusLabel.Text = DrawingSupported and "‚úÖ –¢—Ä–µ–∫–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç!" or "‚ùå –¢—Ä–µ–∫–µ—Ä—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã"
StatusLabel.TextColor3 = DrawingSupported and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 100, 100)
StatusLabel.Font = Enum.Font.Gotham
StatusLabel.TextSize = 11
StatusLabel.TextXAlignment = Enum.TextXAlignment.Left
StatusLabel.Parent = Title

-- –°—á–µ—Ç—á–∏–∫ ESP
local ESPCounter = Instance.new("TextLabel")
ESPCounter.Size = UDim2.new(0, 150, 0, 20)
ESPCounter.Position = UDim2.new(0, 220, 0, 45)
ESPCounter.BackgroundTransparency = 1
ESPCounter.Text = "üìä ESP: 0"
ESPCounter.TextColor3 = Color3.fromRGB(100, 200, 255)
ESPCounter.Font = Enum.Font.Gotham
ESPCounter.TextSize = 11
ESPCounter.TextXAlignment = Enum.TextXAlignment.Left
ESPCounter.Parent = Title

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞
task.spawn(function()
    while wait(1) do
        local doorCount = 0
        local totalCount = 0
        local tracerCount = 0
        
        for _ in pairs(ESP.DoorESP) do
            doorCount = doorCount + 1
        end
        for _ in pairs(ESP.Objects) do
            totalCount = totalCount + 1
        end
        for _ in pairs(ESP.Tracers) do
            tracerCount = tracerCount + 1
        end
        
        ESPCounter.Text = string.format("üìä –î–≤–µ—Ä–µ–π: %d | –í—Å–µ–≥–æ: %d | –õ–∏–Ω–∏–π: %d", doorCount, totalCount, tracerCount)
    end
end)

-- –°–∫—Ä–æ–ª–ª —Ñ—Ä–µ–π–º
local ScrollFrame = Instance.new("ScrollingFrame")
ScrollFrame.Size = UDim2.new(1, -30, 1, -90)
ScrollFrame.Position = UDim2.new(0, 15, 0, 80)
ScrollFrame.BackgroundTransparency = 1
ScrollFrame.ScrollBarThickness = 5
ScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 150, 255)
ScrollFrame.BorderSizePixel = 0
ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
ScrollFrame.Parent = MainFrame

local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0, 12)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Parent = ScrollFrame

UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
    ScrollFrame.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y + 15)
end)

-- –§—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
local function CreateSection(name, icon)
    local Section = Instance.new("Frame")
    Section.Size = UDim2.new(1, 0, 0, 35)
    Section.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
    Section.BorderSizePixel = 0
    Section.Parent = ScrollFrame
    
    local SectionCorner = Instance.new("UICorner")
    SectionCorner.CornerRadius = UDim.new(0, 8)
    SectionCorner.Parent = Section
    
    local SectionLabel = Instance.new("TextLabel")
    SectionLabel.Size = UDim2.new(1, -20, 1, 0)
    SectionLabel.Position = UDim2.new(0, 10, 0, 0)
    SectionLabel.BackgroundTransparency = 1
    SectionLabel.Text = (icon or "‚Ä¢") .. " " .. name
    SectionLabel.TextColor3 = Color3.fromRGB(150, 200, 255)
    SectionLabel.Font = Enum.Font.GothamBold
    SectionLabel.TextSize = 16
    SectionLabel.TextXAlignment = Enum.TextXAlignment.Left
    SectionLabel.Parent = Section
    
    return Section
end

local function CreateToggle(name, icon, callback, default)
    local ToggleFrame = Instance.new("Frame")
    ToggleFrame.Size = UDim2.new(1, 0, 0, 50)
    ToggleFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
    ToggleFrame.BorderSizePixel = 0
    ToggleFrame.Parent = ScrollFrame
    
    local ToggleCorner = Instance.new("UICorner")
    ToggleCorner.CornerRadius = UDim.new(0, 10)
    ToggleCorner.Parent = ToggleFrame
    
    local Button = Instance.new("TextButton")
    Button.Size = UDim2.new(1, 0, 1, 0)
    Button.BackgroundTransparency = 1
    Button.Text = ""
    Button.Parent = ToggleFrame
    
    local Icon = Instance.new("TextLabel")
    Icon.Size = UDim2.new(0, 35, 0, 35)
    Icon.Position = UDim2.new(0, 10, 0.5, -17.5)
    Icon.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
    Icon.Text = icon or "üîπ"
    Icon.TextColor3 = Color3.fromRGB(255, 255, 255)
    Icon.Font = Enum.Font.GothamBold
    Icon.TextSize = 18
    Icon.Parent = ToggleFrame
    
    local IconCorner = Instance.new("UICorner")
    IconCorner.CornerRadius = UDim.new(0, 8)
    IconCorner.Parent = Icon
    
    local Label = Instance.new("TextLabel")
    Label.Size = UDim2.new(1, -120, 1, 0)
    Label.Position = UDim2.new(0, 55, 0, 0)
    Label.BackgroundTransparency = 1
    Label.Text = name
    Label.TextColor3 = Color3.fromRGB(220, 220, 220)
    Label.Font = Enum.Font.Gotham
    Label.TextSize = 15
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = ToggleFrame
    
    local Toggle = Instance.new("Frame")
    Toggle.Size = UDim2.new(0, 50, 0, 26)
    Toggle.Position = UDim2.new(1, -60, 0.5, -13)
    Toggle.BackgroundColor3 = default and Color3.fromRGB(0, 200, 100) or Color3.fromRGB(60, 60, 80)
    Toggle.BorderSizePixel = 0
    Toggle.Parent = ToggleFrame
    
    local ToggleUICorner = Instance.new("UICorner")
    ToggleUICorner.CornerRadius = UDim.new(1, 0)
    ToggleUICorner.Parent = Toggle
    
    local Circle = Instance.new("Frame")
    Circle.Size = UDim2.new(0, 20, 0, 20)
    Circle.Position = default and UDim2.new(1, -23, 0.5, -10) or UDim2.new(0, 3, 0.5, -10)
    Circle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Circle.BorderSizePixel = 0
    Circle.Parent = Toggle
    
    local CircleCorner = Instance.new("UICorner")
    CircleCorner.CornerRadius = UDim.new(1, 0)
    CircleCorner.Parent = Circle
    
    local state = default
    
    Button.MouseButton1Click:Connect(function()
        state = not state
        
        local TweenService = game:GetService("TweenService")
        
        TweenService:Create(Toggle, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {
            BackgroundColor3 = state and Color3.fromRGB(0, 200, 100) or Color3.fromRGB(60, 60, 80)
        }):Play()
        
        TweenService:Create(Circle, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {
            Position = state and UDim2.new(1, -23, 0.5, -10) or UDim2.new(0, 3, 0.5, -10)
        }):Play()
        
        pcall(function()
            callback(state)
        end)
    end)
    
    return ToggleFrame
end

local function CreateSlider(name, icon, min, max, default, callback)
    local SliderFrame = Instance.new("Frame")
    SliderFrame.Size = UDim2.new(1, 0, 0, 75)
    SliderFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
    SliderFrame.BorderSizePixel = 0
    SliderFrame.Parent = ScrollFrame
    
    local SliderCorner = Instance.new("UICorner")
    SliderCorner.CornerRadius = UDim.new(0, 10)
    SliderCorner.Parent = SliderFrame
    
    local Icon = Instance.new("TextLabel")
    Icon.Size = UDim2.new(0, 30, 0, 30)
    Icon.Position = UDim2.new(0, 10, 0, 10)
    Icon.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
    Icon.Text = icon or "‚ö°"
    Icon.TextColor3 = Color3.fromRGB(255, 255, 255)
    Icon.Font = Enum.Font.GothamBold
    Icon.TextSize = 16
    Icon.Parent = SliderFrame
    
    local IconCorner = Instance.new("UICorner")
    IconCorner.CornerRadius = UDim.new(0, 8)
    IconCorner.Parent = Icon
    
    local Label = Instance.new("TextLabel")
    Label.Size = UDim2.new(1, -100, 0, 30)
    Label.Position = UDim2.new(0, 50, 0, 10)
    Label.BackgroundTransparency = 1
    Label.Text = name
    Label.TextColor3 = Color3.fromRGB(220, 220, 220)
    Label.Font = Enum.Font.GothamBold
    Label.TextSize = 14
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = SliderFrame
    
    local ValueLabel = Instance.new("TextLabel")
    ValueLabel.Size = UDim2.new(0, 50, 0, 30)
    ValueLabel.Position = UDim2.new(1, -60, 0, 10)
    ValueLabel.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
    ValueLabel.Text = tostring(default)
    ValueLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
    ValueLabel.Font = Enum.Font.GothamBold
    ValueLabel.TextSize = 14
    ValueLabel.Parent = SliderFrame
    
    local ValueCorner = Instance.new("UICorner")
    ValueCorner.CornerRadius = UDim.new(0, 8)
    ValueCorner.Parent = ValueLabel
    
    local SliderBG = Instance.new("Frame")
    SliderBG.Size = UDim2.new(1, -20, 0, 8)
    SliderBG.Position = UDim2.new(0, 10, 1, -20)
    SliderBG.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
    SliderBG.BorderSizePixel = 0
    SliderBG.Parent = SliderFrame
    
    local BGCorner = Instance.new("UICorner")
    BGCorner.CornerRadius = UDim.new(1, 0)
    BGCorner.Parent = SliderBG
    
    local Fill = Instance.new("Frame")
    Fill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
    Fill.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
    Fill.BorderSizePixel = 0
    Fill.Parent = SliderBG
    
    local FillCorner = Instance.new("UICorner")
    FillCorner.CornerRadius = UDim.new(1, 0)
    FillCorner.Parent = Fill
    
    local Dragging = false
    
    local function Update(input)
        local pos = math.clamp((input.Position.X - SliderBG.AbsolutePosition.X) / SliderBG.AbsoluteSize.X, 0, 1)
        local value = math.floor(min + (max - min) * pos)
        
        game:GetService("TweenService"):Create(Fill, TweenInfo.new(0.1), {
            Size = UDim2.new(pos, 0, 1, 0)
        }):Play()
        
        ValueLabel.Text = tostring(value)
        
        pcall(function()
            callback(value)
        end)
    end
    
    SliderBG.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            Dragging = true
            Update(input)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if Dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            Update(input)
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            Dragging = false
        end
    end)
    
    return SliderFrame
end

local function CreateButton(name, icon, callback)
    local ButtonFrame = Instance.new("Frame")
    ButtonFrame.Size = UDim2.new(1, 0, 0, 50)
    ButtonFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 50)
    ButtonFrame.BorderSizePixel = 0
    ButtonFrame.Parent = ScrollFrame
    
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(0, 10)
    ButtonCorner.Parent = ButtonFrame
    
    local Button = Instance.new("TextButton")
    Button.Size = UDim2.new(1, 0, 1, 0)
    Button.BackgroundTransparency = 1
    Button.Text = ""
    Button.Parent = ButtonFrame
    
    local Icon = Instance.new("TextLabel")
    Icon.Size = UDim2.new(0, 35, 0, 35)
    Icon.Position = UDim2.new(0, 10, 0.5, -17.5)
    Icon.BackgroundColor3 = Color3.fromRGB(50, 50, 70)
    Icon.Text = icon or "üîπ"
    Icon.TextColor3 = Color3.fromRGB(255, 255, 255)
    Icon.Font = Enum.Font.GothamBold
    Icon.TextSize = 18
    Icon.Parent = ButtonFrame
    
    local IconCorner = Instance.new("UICorner")
    IconCorner.CornerRadius = UDim.new(0, 8)
    IconCorner.Parent = Icon
    
    local Label = Instance.new("TextLabel")
    Label.Size = UDim2.new(1, -60, 1, 0)
    Label.Position = UDim2.new(0, 55, 0, 0)
    Label.BackgroundTransparency = 1
    Label.Text = name
    Label.TextColor3 = Color3.fromRGB(220, 220, 220)
    Label.Font = Enum.Font.Gotham
    Label.TextSize = 15
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = ButtonFrame
    
    Button.MouseButton1Click:Connect(function()
        pcall(callback)
        
        local TweenService = game:GetService("TweenService")
        TweenService:Create(ButtonFrame, TweenInfo.new(0.1), {
            BackgroundColor3 = Color3.fromRGB(45, 45, 60)
        }):Play()
        wait(0.1)
        TweenService:Create(ButtonFrame, TweenInfo.new(0.1), {
            BackgroundColor3 = Color3.fromRGB(35, 35, 50)
        }):Play()
    end)
    
    return ButtonFrame
end

-- –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–µ–Ω—é
CreateSection("ESP –ù–∞—Å—Ç—Ä–æ–π–∫–∏", "üéØ")

CreateToggle("ESP –í–∫–ª—é—á–µ–Ω", "üëÅÔ∏è", function(state)
    Config.ESP.Enabled = state
    StatusLabel.Text = state and "‚úÖ ESP –ê–∫—Ç–∏–≤–µ–Ω!" or "‚ùå ESP –í—ã–∫–ª—é—á–µ–Ω"
    StatusLabel.TextColor3 = state and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
    if not state then ESP:Clear() end
end, Config.ESP.Enabled)

CreateToggle("ESP –î–≤–µ—Ä–µ–π (–û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù)", "üö™", function(state)
    Config.ESP.Doors = state
    if not state then
        for door, _ in pairs(ESP.DoorESP) do
            ESP:Remove(door)
        end
    end
end, Config.ESP.Doors)

CreateToggle("ESP –ö–ª—é—á–µ–π + –†—ã—á–∞–≥–æ–≤", "üîë", function(state)
    Config.ESP.Keys = state
end, Config.ESP.Keys)

CreateToggle("ESP –ü—Ä–µ–¥–º–µ—Ç–æ–≤", "üì¶", function(state)
    Config.ESP.Items = state
end, Config.ESP.Items)

CreateToggle("ESP –ú–æ–Ω—Å—Ç—Ä–æ–≤", "üëπ", function(state)
    Config.ESP.Entities = state
end, Config.ESP.Entities)

CreateToggle("–¢—Ä–µ–∫–µ—Ä—ã (–õ–∏–Ω–∏–∏)", "üìç", function(state)
    Config.ESP.Tracers = state
    if not DrawingSupported then
        StatusLabel.Text = "‚ùå Drawing API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω!"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
    else
        StatusLabel.Text = state and "‚úÖ –¢—Ä–µ–∫–µ—Ä—ã –≤–∫–ª—é—á–µ–Ω—ã!" or "‚ùå –¢—Ä–µ–∫–µ—Ä—ã –≤—ã–∫–ª—é—á–µ–Ω—ã"
        StatusLabel.TextColor3 = state and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 100, 100)
    end
end, Config.ESP.Tracers)

CreateToggle("–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–∏—Å—Ç–∞–Ω—Ü–∏—é", "üìè", function(state)
    Config.ESP.ShowDistance = state
end, Config.ESP.ShowDistance)

CreateSlider("–ú–∞–∫—Å. –¥–∏—Å—Ç–∞–Ω—Ü–∏—è ESP", "üî≠", 100, 1000, Config.ESP.MaxDistance, function(value)
    Config.ESP.MaxDistance = value
end)

CreateSlider("–î–∏–∞–ø–∞–∑–æ–Ω –¥–≤–µ—Ä–µ–π –≤–ø–µ—Ä–µ–¥–∏", "üö™", 1, 5, Config.ESP.DoorRange, function(value)
    Config.ESP.DoorRange = value
    ESP:AggressiveCleanDoors()
end)

CreateSlider("–ú–∞–∫—Å. ESP –¥–≤–µ—Ä–µ–π", "üìä", 1, 5, Config.ESP.MaxDoorsESP, function(value)
    Config.ESP.MaxDoorsESP = value
    ESP:AggressiveCleanDoors()
end)

CreateButton("üßπ –û—á–∏—Å—Ç–∏—Ç—å ESP –¥–≤–µ—Ä–µ–π", "üóëÔ∏è", function()
    local removed = 0
    for door, _ in pairs(ESP.DoorESP) do
        ESP:Remove(door)
        removed = removed + 1
    end
    StatusLabel.Text = string.format("üßπ –û—á–∏—â–µ–Ω–æ –¥–≤–µ—Ä–µ–π: %d", removed)
    StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 0)
end)

CreateSection("–ò–≥—Ä–æ–∫", "üë§")

CreateToggle("–°–∫–æ—Ä–æ—Å—Ç—å (–ù–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è)", "‚ö°", function(state)
    Config.Speed.Enabled = state
    if state then
        SpeedSystem:Enable()
    else
        SpeedSystem:Disable()
    end
end, Config.Speed.Enabled)

CreateSlider("–ó–Ω–∞—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏", "üèÉ", 16, 100, Config.Speed.Value, function(value)
    Config.Speed.Value = value
end)

CreateToggle("üõ°Ô∏è God Mode", "üí™", function(state)
    Config.GodMode.Enabled = state
    if state then
        GodMode:Enable()
    else
        GodMode:Disable()
    end
end, Config.GodMode.Enabled)

-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–∫–Ω–æ–º
local CloseButton = Instance.new("TextButton")
CloseButton.Size = UDim2.new(0, 40, 0, 40)
CloseButton.Position = UDim2.new(1, -50, 0, 15)
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
CloseButton.Text = "‚úï"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 22
CloseButton.BorderSizePixel = 0
CloseButton.Parent = MainFrame

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(1, 0)
CloseCorner.Parent = CloseButton

CloseButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
end)

local MinButton = Instance.new("TextButton")
MinButton.Size = UDim2.new(0, 40, 0, 40)
MinButton.Position = UDim2.new(1, -95, 0, 15)
MinButton.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
MinButton.Text = "‚àí"
MinButton.TextColor3 = Color3.fromRGB(255, 255, 255)
MinButton.Font = Enum.Font.GothamBold
MinButton.TextSize = 24
MinButton.BorderSizePixel = 0
MinButton.Parent = MainFrame

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(1, 0)
MinCorner.Parent = MinButton

local minimized = false
MinButton.MouseButton1Click:Connect(function()
    minimized = not minimized
    
    game:GetService("TweenService"):Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
        Size = minimized and UDim2.new(0, 450, 0, 70) or UDim2.new(0, 450, 0, 670)
    }):Play()
    
    ScrollFrame.Visible = not minimized
    MinButton.Text = minimized and "+" or "‚àí"
end)

-- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
local dragging = false
local dragInput, dragStart, startPos

Title.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

Title.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end)

-- –ì–æ—Ä—è—á–∞—è –∫–ª–∞–≤–∏—à–∞
UserInputService.InputBegan:Connect(function(input, gpe)
    if not gpe and input.KeyCode == Enum.KeyCode.Insert then
        MainFrame.Visible = not MainFrame.Visible
    end
end)

-- –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º
ESP:ScanWorkspace()

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ESP
RunService.RenderStepped:Connect(function()
    ESP:Update()
end)

-- –ó–∞—â–∏—Ç–∞ –ø—Ä–∏ —Ä–µ—Å–ø–∞–≤–Ω–µ
LocalPlayer.CharacterAdded:Connect(function()
    task.wait(1)
    if Config.GodMode.Enabled then
        GodMode:Enable()
    end
    if Config.Speed.Enabled then
        SpeedSystem:Enable()
    end
end)

-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
if Config.Speed.Enabled then
    SpeedSystem:Enable()
end

-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "üéØ DOORS HUB v1.5";
    Text = DrawingSupported and "‚úÖ –¢–†–ï–ö–ï–†–´ –†–ê–ë–û–¢–ê–Æ–¢!" or "‚ùå –¢—Ä–µ–∫–µ—Ä—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã";
    Duration = 5;
})

print("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ")
print("‚úÖ DOORS HUB v1.5 - –¢–†–ï–ö–ï–†–´ –ò–°–ü–†–ê–í–õ–ï–ù–´")
if DrawingSupported then
    print("üìç Drawing API –∑–∞–≥—Ä—É–∂–µ–Ω - —Ç—Ä–µ–∫–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç!")
else
    print("‚ùå Drawing API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - —Ç—Ä–µ–∫–µ—Ä—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã")
end
print("üö™ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–≤–µ—Ä–µ–π –∞–∫—Ç–∏–≤–Ω–∞")
print("‚ö° –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç")
print("üéÆ INSERT - –æ—Ç–∫—Ä—ã—Ç—å/–∑–∞–∫—Ä—ã—Ç—å –º–µ–Ω—é")
print("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ")
